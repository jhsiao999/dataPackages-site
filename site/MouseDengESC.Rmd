---
title: "Making MouseDengESC package (GSE45719)"
output:
  html_document:
    css: floating-toc.css
    toc: true
---

**Last updated:** `r Sys.Date()`

**Code version:** `r system("git log -1 --format='%H'", intern = TRUE)`

---

```{r, include = FALSE}
library(knitr)
opts_chunk$set(eval = FALSE, echo = TRUE)
```


### Load packages

```{r}
library(data.table)
library(Biobase)
```


### Deng et al 2014, counts

```{r, eval = F}
counts <- read.table('../data/MouseDengESC/Deng_cell_data.txt', 
                    skip = 2, header = FALSE, stringsAsFactors = FALSE)
geneNames <- counts[,1]
counts <- counts[,-1]

header <- as.character(unlist(read.table('../data/MouseDengESC/Deng_cell_data.txt',
                                          nrows = 1, header = FALSE)))

# make phenoData object
col_data <- data.frame(
  sample_id = paste0("cell","_",c(1:length(header))),
  cell_type = header)
rownames(col_data) <- col_data$sample_id

# make featureData object
row_data <- data.frame(geneName = geneNames,
                       stringsAsFactors = FALSE)
rownames(row_data) <- row_data$geneName

colnames(counts) <- col_data$sample_id
rownames(counts) <- row_data$geneName
# make metadata list
meta_list <- data.frame(labelDescription = c("sample ID",
                                             "embryo type"),
                        row.names = colnames(col_data))

eset_gse <- new("ExpressionSet",
            exprs = as.matrix(counts),
            phenoData = new("AnnotatedDataFrame",
                            data = col_data),
            featureData = new("AnnotatedDataFrame",
                              data = row_data),
            experimentData = new("MIAME",
                                 title = "Deng 2014 Mouse ESC (downloded from GEO)"))

# load the conquer-curated data
library("MultiAssayExperiment")
multiassay_conquer <- readRDS(file = "../data/MouseDengESC/conquer-GSE45719.rds")

save(eset_gse, multiassay_conquer, 
        file = "../data/all-rda/MouseDengESC.rda")
```



### Session information

```{r}
sessionInfo()
```

